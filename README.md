# garbage-classify
自今年 7 月 1 日起，上海市将正式实施 《上海市生活垃圾管理条例》。垃圾分类，看似是微不足道的“小事”，实则关系到13亿多人生活环境的改善，理应大力提倡。垃圾识别分类数据集中包括玻璃 (glass) 、硬纸板 (cardboard) 、金属 (metal) 、纸 (paper) 、塑料 (plastic) 、一般垃圾 (trash) ，共6个类别。生活垃圾由于种类繁多，具体分类缺乏统一标准，大多人在实际操作时会“选择困难”。本选题基于深度学习技术建立准确的分类模型，利用技术手段改善人居环境。

本项目使用 Inception-ResNet-v2 进行垃圾分类，数据集一共分了六个类别，分别是：cardboard glass metal paper plastic trash，一共 2527 个样本。



图像中突出部分的大小差别很大。例如，玻璃的图像可以是以下任意情况。每张图像中玻璃所占区域都是不同的。
从左到右，玻璃所占整个图的面积不断增加，由于信息位置的巨大差异，为卷积操作选择合适的卷积核大小就比较困难。信息分布更全局性的图像偏好较大的卷积核，信息分布比较局部的图像偏好较小的卷积核。如果只是简单地堆叠较大的卷积层会非常消耗计算资源。


结合在图像分类的特点考虑在同一层级上运行具备多个尺寸的滤波器，网络本质上会变得稍微「宽一些」，而不是「更深」上图是Inception v1的 模块结构。它使用 3 个不同大小的滤波器（1x1、3x3、5x5）对输入执行卷积操作，此外它还会执行最大池化。所有子层的输出最后会被级联起来，并传送至下一个 Inception 模块。



网络越深，能获取的信息越多，而且特征也越丰富。但是根据实验表明，随着网络的加深，优化效果反而越差，测试数据和训练数据的准确率反而降低了。这是由于网络的加深会造成梯度爆炸和梯度消失的问题。
而残差网络就能解决这一问题。利用一个非线性单元f(x;Θ)函数逼近目标函数h(x)。而上图是一个残差单元，这里由两个等宽卷积和一个跨层的直连边组成，再通过ReLU函数激活后输出。



而本项目选用了Inception-ResNet-v2模型。
其中stem层是采用了inception的设计，其中conv也使用了连续的7*1+1*7来替代7*7的卷积这种优化方式。
其中inception-resnet-A部分设计，inception+残差网络设计
其中inception-resnet-A部分设计，inception+残差网络设计
其中inception-resnet-A部分设计，inception+残差网络设计
其中reduction A、reduction A 部分采用inception的设计，其中在进行3x3卷积之前先进行一次1x1的卷积来减少特征的映射深度。
再使用average polling。通过去掉 Feature Map 中不重要的样本，进一步减少参数数量。
最后使用softmax函数回归将神经网络的输出转换为概率结果，以便预测属于哪个分类。



图像经过卷积处理之后，得到特征值的映射。假设有一个 5*5 的图像，使用一个 3*3 的 滤波器进行卷积（这里的步长为1，没有进行填充），得到了到一个 3*3 的 Feature Map值，每个卷积层可以有多个 滤波器。每个 滤波器和原始图像进行卷积后，都可以得到一个 Feature Map 可以作为下一次操作的输入值。因此，卷积后 Feature Map 的深度 (个数) 和卷积层的滤波器个数是相同的。如果步长移动和滤波器不合适的时候，可以进行零填充。

池化层主要的作用是下采样，通过去掉 Feature Map 中不重要的样本，进一步减少参数数量。池化的方法很多，最常用的是 Max Pooling。Max Pooling 实际上就是在  个样本中取最大值，作为采样后的样本值。除了 Max Pooing 之外，常用的还有 Mean Pooling—— 取各样本的平均值。

使用训练好的模型对测试集中的随机10个数据进行预测，这里选用训练时得到的概率最高的模型来进行预测。输出结果如下，其中有两个数据的预测值和真实值出现了偏差。

